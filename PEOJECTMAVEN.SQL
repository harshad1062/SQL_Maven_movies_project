USE MAVENMOVIES;

-- UNDERSTANDING THE SCHEMA --

SELECT * FROM RENTAL;

SELECT CUSTOMER_ID, RENTAL_DATE
FROM RENTAL;

SELECT * FROM INVENTORY;

SELECT * FROM FILM;

SELECT * FROM CUSTOMER;

-- You need to provide customer firstname, lastname and email id to the marketing team --

SELECT first_name, last_name,EMAIL
FROM CUSTOMER;

-- How many movies are with rental rate of $0.99? --

SELECT COUNT(*) AS CHEAPEST_RENTALS
FROM FILM
WHERE RENTAL_RATE=0.99;

-- We want to see rental rate and how many movies are in each rental category --

SELECT RENTAL_RATE,COUNT(*) AS NUMBER_OF_MOVIES
FROM FILM
GROUP BY RENTAL_RATE;

-- Which rating has the most films? --

SELECT RATING,COUNT(*) AS RATING_CC
FROM FILM
GROUP BY RATING
ORDER BY RATING_CC DESC;

-- Which rating is most prevalant in each store? --
SELECT I.STORE_ID,F.RATING,COUNT(F.RATING) AS TOTAL_FILMS
FROM INVENTORY AS I LEFT join
FILM AS F
ON I.FILM_ID = F.FILM_ID 
GROUP BY I.STORE_ID,F.RATING 
order by TOTAL_FILMS DESC;

-- List of films by Film Name, Category, Language --
SELECT F.TITLE AS FILM_NAME,C.NAME AS CATEGORY_NAME,LAN.NAME AS LANGUAGE_NAME
FROM FILM_CATEGORY AS FC LEFT JOIN CATEGORY AS C 
ON FC.CATEGORY_ID=C.CATEGORY_ID LEFT JOIN FILM AS F
ON FC.FILM_ID=F.FILM_ID LEFT JOIN LANGUAGE  AS LAN
ON F.LANGUAGE_ID = LAN.LANGUAGE_ID;






